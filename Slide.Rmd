---
title: "The Causes of Death in the World"
subtitle: "Really3Q"
author: "JingyiShi MiaoSun JingwenOu YuQin"
institute: "Department of Econometrics and Business Statistics"
output:
  xaringan::moon_reader:
    lib_dir: libs
    yolo: FALSE
---

```{r,  echo=FALSE, eval=TRUE}
options(htmltools.dir.version = FALSE)
```

```{r , echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(ggplot2)
library(readr)
library(knitr)
library(plotly)
library(gganimate)
library(gifski)
library(DT)
library(broom)
```

```{r ,echo = FALSE, message = FALSE, warning = FALSE }
annual_number_of_deaths_by_cause <- read_csv("Data/annual-number-of-deaths-by-cause.csv", 
    col_types = cols(`Number of executions` = col_double())) 
```

```{r,echo = FALSE, message = FALSE, warning = FALSE}
Mexico <- annual_number_of_deaths_by_cause %>%
  filter(Country == "Mexico") %>%
  filter(!is.na(Code), Year >= 2005) %>%
  pivot_longer(cols = c(4:36), 
               names_to = "Death_cause", 
               values_to = "Count") %>% 
  group_by(Death_cause) %>% 
  summarise(Death_amount=sum(Count, na.rm = TRUE))%>%
  arrange(desc(Death_amount))

Germany <- annual_number_of_deaths_by_cause %>%
  filter(Country == "Germany") %>%
  filter(!is.na(Code), Year >= 2005) %>%
  pivot_longer(cols = c(4:36), 
               names_to = "Death_cause", 
               values_to = "Count") %>% 
  group_by(Death_cause) %>% 
  summarise(Death_amount=sum(Count, na.rm = TRUE))%>%
  arrange(desc(Death_amount))



Mexico_cause <- annual_number_of_deaths_by_cause %>% 
    select(-2, -4) %>% 
  filter(Country == "Mexico",
         Year >= 2005) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count") 
Mexico_plot <- Mexico_cause %>%
  filter(Death_cause %in% c("Cardiovascular diseases", 
                            "Neoplasms",
                            "Chronic kidney disease",
                            "Digestive diseases",
                            "Diabetes mellitus")) %>%
  ggplot(mapping = aes(x = Year)) +
  geom_line(aes(y = Count,
  color = Death_cause)) +
  ggtitle("Mexico death cause trend")+
  theme_bw()

Germany_cause <- annual_number_of_deaths_by_cause %>% 
    select(-2, -4) %>% 
  filter(Country == "Germany",
         Year >= 2005) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count") 
Germany_plot <- Germany_cause %>%
  filter(Death_cause %in% c("Cardiovascular diseases", 
                            "Neoplasms",
                            "Digestive diseases",
                            "Alzheimer's disease and other dementias",
                            "Chronic respiratory diseases")) %>%
  ggplot(mapping = aes(x = Year)) +
  geom_line(aes(y = Count,
  color = Death_cause)) +
  ggtitle("Germany death cause trend")+
  theme_bw()
```

---
class: inverse 
## Interested Country: Mexico and Germany

<br>
<br>
--
**Q1: In Mexico and Germany, what are the top five diseases that cause the most deaths from 2005?**
<br>
<br>
--
**Q2: What are the trends of these countries over the 15 yearsï¼Ÿ**

---
## Table of top 5 cauese of death in Mexico since 2005
--
```{r echo = FALSE, warning = FALSE, message = FALSE}
Mexico %>% 
  arrange(desc(Death_amount)) %>% 
  head(5) %>% 
  kable( )
```

---
## Table of top 5 cauese of death in Germany since 2005
--
```{r, echo = FALSE, warning = FALSE, message = FALSE}
Germany %>% 
  arrange(desc(Death_amount)) %>% 
  head(5) %>% 
  kable( )
```

---
## Grpah of the tend of these disease since 2005
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.align="center",out.width = '100%', }
ggplotly(Mexico_plot)
```

---
## Grpah of the tend of these disease since 2005
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.align="center",out.width = '110%', }
ggplotly(Germany_plot)
```

