---
title: "Select"
subtitle: "select"
author: "really3Q"
institute: "Department of Econometrics and Business Statistics"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: css/style.css
    yolo: FALSE
---

```{r,setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

```{r , echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
library(ggplot2)
library(readr)
library(knitr)
library(plotly)
library(gganimate)
library(gifski)
library(DT)
library(broom)
```

```{r,  echo = FALSE, message = FALSE, warning = FALSE}
annual_number_of_deaths_by_cause <- read_csv("Data/annual-number-of-deaths-by-cause.csv", 
    col_types = cols(`Number of executions` = col_double()))
life_expectancy <- read_csv("Data/life-expectancy.csv")
GDP <- read_csv("Data/GDP.csv")
```


















































































































































































































































































































































































































































































```{r echo = FALSE, warning = FALSE, message = FALSE}
disease_data_Benin <- annual_number_of_deaths_by_cause %>% 
  select(1,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36) %>% 
  filter(Country %in% c("Benin"),
         (Year >= 2000)) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count")%>%
  group_by(Death_cause) %>% 
  summarise(Death_amount=sum(Count, na.rm = TRUE))%>%
arrange(desc(Death_amount))%>%
  head(n=5)

disease_data_Mozambique <- annual_number_of_deaths_by_cause %>% 
  select(1,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36) %>% 
  filter(Country %in% c("Mozambique"),
         (Year >= 2000)) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count")%>%
  group_by(Death_cause) %>% 
  summarise(Death_amount=sum(Count, na.rm = TRUE))%>%
arrange(desc(Death_amount))%>%
  head(disease_data_Mozambique,n=5)

disease_data_Benin_plot <- annual_number_of_deaths_by_cause %>% 
  select(1,3,9,13,16,17,18,22) %>% 
  filter(Country %in% c("Benin"),
         (Year >= 2000)) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count")

disease_data_Mozambique_plot <- annual_number_of_deaths_by_cause %>% 
  select(1,3,9,13,15,16,18) %>% 
  filter(Country %in% c("Mozambique"),
         (Year >= 2000)) %>% 
  pivot_longer(cols =  -c(1:2), 
               names_to = "Death_cause", 
               values_to = "Count")

Q1 <- ggplot(disease_data_Benin_plot, aes(x=Year, 
 y= Count,
 color=Death_cause))+geom_line(size=1)+ggtitle("Trends of top five death rate in Benin")

Q2 <- ggplot(disease_data_Mozambique_plot, aes(x=Year, 
 y= Count,
 color=Death_cause))+geom_line(size=1)+ggtitle("Trends of top five death rate in Mozambique")
 
```
---
class: inverse 
## Interested Country: Benin and Mozambique

<br>
<br>
--
**Q1: What are top 5 reasons to cause death in Benin and Mozambique, and what may be the reason for it? **
<br>
<br>
--
**Q2: What is the development trend of these reasons in the above question?**

---
## Table of top 5 cauese of death in Benin since 2000
--
```{r echo = FALSE, warning = FALSE, message = FALSE}
disease_data_Benin %>% kable
```
---
## Table of top 5 cauese of death in Mozambique since 2000
--
```{r echo = FALSE, warning = FALSE, message = FALSE, fig.align="center",out.width = '120%'}
disease_data_Mozambique %>% kable
```
---
## Grpah of the tend of these disease since 2000
```{r echo = FALSE, warning = FALSE, message = FALSE}
gridExtra::grid.arrange(Q1,Q2, nrow = 2)
```

---
class: inverse 
## Conclusion

